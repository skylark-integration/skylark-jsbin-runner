/**
 * skylark-jsbin-runner - A version of jsbin-runner  that ported to running on skylarkjs.
 * @author Hudaokeji, Inc.
 * @version v0.9.0
 * @link https://github.com/skylark-integration/skylark-jsbin-runner/
 * @license MIT
 */
define(["./runner","./utils"],function(e,t){var n={target:null,old:null,active:null,state:{}};return n.guid=+new Date,n.create=function(){var e=document.createElement("iframe");return e.setAttribute("sandbox","allow-modals allow-forms allow-pointer-lock allow-popups allow-same-origin allow-scripts"),e.setAttribute("frameBorder","0"),e.setAttribute("name","JS Bin Output "),e.id=n.guid++,e},n.use=function(e,o){if(!n.target)throw new Error("Sandbox has no target element.");n.old=n.active,n.saveState(n.old),n.active=e,t.prependChild(n.target,e),setTimeout(function(){o&&o();for(var e,t=n.target.getElementsByTagName("iframe"),r=t.length,i=0,a=n.active.id;e=t[i],i<r;i++)e.id!==a&&(e.parentNode.removeChild(e),r--)},0)},n.restoreState=function(e,n){if(!e)return{};var o=t.getIframeWindow(e);if(!o)return{};n.scroll&&o.scrollTo(n.scroll.x,n.scroll.y)},n.saveState=function(e){if(!e)return{};var n=t.getIframeWindow(e);return n?{scroll:{x:n.scrollX,y:n.scrollY}}:{}},n.wrap=function(o,r){o&&(r=r||{},t.addEvent(o,"resize",t.throttle(function(){e.postMessage("resize",n.getSizeProperties(o))},25)),e.postMessage("resize",n.getSizeProperties(o)),t.addEvent(o,"focus",function(){e.postMessage("focus")}))},n.getSizeProperties=function(e){return{width:e.innerWidth||e.document.documentElement.clientWidth,height:e.innerHeight||e.document.documentElement.clientHeight,offsetWidth:e.document.documentElement.offsetWidth,offsetHeight:e.document.documentElement.offsetHeight}},n.eval=function(e){if(!n.active)throw new Error("sandbox.eval: has no active iframe.");var t=/(^.|\b)console\.(\S+)/g;if(t.test(e)){e=e.replace(t,function(e,t,n){return"window.runnerWindow.proxyConsole."+n})}var o=n.active.contentWindow,r=null,i="log";try{r=o.eval(e)}catch(e){r=e.message,i="error"}return proxyConsole[i](r)},n.injectScript=function(e,t){if(!n.active)throw new Error("sandbox.injectScript: has no active iframe.");var o=n.active.contentWindow.document,r=o.createElement("script");r.src=e,r.onload=function(){t()},r.onerror=function(){t('Failed to load "'+e+'"')},o.body.appendChild(r)},n.injectDOM=function(e,t){if(!n.active)throw new Error("sandbox.injectDOM: has no active iframe.");var o=n.active.contentWindow.document;try{o.body.innerHTML=e}catch(e){t("Failed to load DOM.")}t()},e.sandbox=n});
//# sourceMappingURL=sourcemaps/sandbox.js.map
