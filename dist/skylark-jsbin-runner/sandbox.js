/**
 * skylark-jsbin-runner - A version of jsbin-runner  that ported to running on skylarkjs.
 * @author Hudaokeji, Inc.
 * @version v0.9.0
 * @link https://github.com/skylark-integration/skylark-jsbin-runner/
 * @license MIT
 */
define(["./runner","./utils","./proxy-console"],function(e,t,n){"use strict";var o={target:null,old:null,active:null,state:{}};return o.guid=+new Date,o.create=function(){var e=document.createElement("iframe");return e.setAttribute("sandbox","allow-modals allow-forms allow-pointer-lock allow-popups allow-same-origin allow-scripts"),e.setAttribute("frameBorder","0"),e.setAttribute("name","JS Bin Output "),e.id=o.guid++,e},o.use=function(e,n){if(!o.target)throw new Error("Sandbox has no target element.");o.old=o.active,o.saveState(o.old),o.active=e,t.prependChild(o.target,e),setTimeout(function(){n&&n();for(var e,t=o.target.getElementsByTagName("iframe"),r=t.length,i=0,a=o.active.id;e=t[i],i<r;i++)e.id!==a&&(e.parentNode.removeChild(e),r--)},0)},o.restoreState=function(e,n){if(!e)return{};var o=t.getIframeWindow(e);if(!o)return{};n.scroll&&o.scrollTo(n.scroll.x,n.scroll.y)},o.saveState=function(e){if(!e)return{};var n=t.getIframeWindow(e);return n?{scroll:{x:n.scrollX,y:n.scrollY}}:{}},o.wrap=function(n,r){n&&(r=r||{},t.addEvent(n,"resize",t.throttle(function(){e.postMessage("resize",o.getSizeProperties(n))},25)),e.postMessage("resize",o.getSizeProperties(n)),t.addEvent(n,"focus",function(){e.postMessage("focus")}))},o.getSizeProperties=function(e){return{width:e.innerWidth||e.document.documentElement.clientWidth,height:e.innerHeight||e.document.documentElement.clientHeight,offsetWidth:e.document.documentElement.offsetWidth,offsetHeight:e.document.documentElement.offsetHeight}},o.eval=function(e){if(!o.active)throw new Error("sandbox.eval: has no active iframe.");var t=/(^.|\b)console\.(\S+)/g;if(t.test(e)){e=e.replace(t,function(e,t,n){return"window.runnerWindow.proxyConsole."+n})}var r=o.active.contentWindow,i=null,a="log";try{i=r.eval(e)}catch(e){i=e.message,a="error"}return n[a](i)},o.injectScript=function(e,t){if(!o.active)throw new Error("sandbox.injectScript: has no active iframe.");var n=o.active.contentWindow.document,r=n.createElement("script");r.src=e,r.onload=function(){t()},r.onerror=function(){t('Failed to load "'+e+'"')},n.body.appendChild(r)},o.injectDOM=function(e,t){if(!o.active)throw new Error("sandbox.injectDOM: has no active iframe.");var n=o.active.contentWindow.document;try{n.body.innerHTML=e}catch(e){t("Failed to load DOM.")}t()},e.sandbox=o});
//# sourceMappingURL=sourcemaps/sandbox.js.map
